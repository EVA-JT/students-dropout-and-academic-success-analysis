---
title: "Atividade AB1.1"
author: "Davi Celestino dos Santos Barbosa e João Victor Tenório Venancio"
output: html_document
date: "2025-08-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Contexto da base de dados

A base de dados escolhida é criada a partir de uma instituição de ensino superior (adquirido de diversas bases de dados distintas) relacionado a alunos matriculados em diferentes cursos de graduação, como agronomia, design, educação, enfermagem, jornalismo, administração, serviço social e tecnologias. O conjunto de dados original inclui informações conhecidas no momento da matrícula do aluno (trajetória acadêmica, dados demográficos e fatores socioeconômicos) e o desempenho acadêmico dos alunos ao final do primeiro e segundo semestres.

A base foi alterada para otimizar a eficiência da análise. Foram removidas no total 23 colunas de informações consideradas redundantes ou irrelevantes. Os nomes das colunas restantes, bem como os valores da variável ‘Resultado’, foram traduzidos para o português, colunas que utilizavam codificação numérica para representar categorias (como a coluna ‘Gênero’, que usava 0 e 1) foram convertidas para seus respectivos rótulos descritivos (‘Homem’ e ‘Mulher’), tornando a base mais legível.

## 1. Análise exploratória dos dados

Uma abordagem para analisar dados que visa entender suas características principais, descobrir padrões, identificar anomalias e verificar hipóteses, antes de aplicar modelos formais de análise ou modelagem.

### Importar a base de dados usando a função read.csv

```{r}
setwd("C:\\Users\\davic\\OneDrive\\Documentos\\R\\data")
#Colocando o caminho para o arquivo

df <- read.csv("data_ADAPTED.csv", sep = ",", dec = ".", header = TRUE)

```
 
### Verificar quantidade de linhas e colunas

```{r}
nrow(df)
ncol(df)
```

### Verificar nomes das colunas

```{r}
colnames(df)
```

### Verificar tipo de dados

```{r}
class(df)
class(df$Curso)
class(df$Ordem.de.prioridade.do.curso)
class(df$Nota.da.qualificacao.anterior)
class(df$Nota.de.admissao)
class(df$Deslocado)
class(df$Necessidades.educacionais.especiais)
class(df$Devedor)
class(df$Genero)
class(df$Bolsista)
class(df$Idade.na.inscricao)
class(df$Internacional)
class(df$Materias.do.primeiro.semestre.aprovadas)
class(df$Media.das.notas.do.primeiro.semestre)
class(df$Resultado)
```

### Identificar valores ausentes

```{r}
colSums(is.na(df))
```


## 2. Análise de variável numérica contínua

Variáveis numéricas contínuas são variáveis quantitativas que podem assumir qualquer valor dentro de um intervalo específico, incluindo valores fracionários ou decimais.
Na nossa base de dados temos um total de 3 variáveis numéricas contínuas, são elas: 'Nota da qualificacao anterior', 'Nota de adimissao' e 'Media das notas do primeiro semestre'.

Para o prosseguimento do item 2, escolhemos a coluna 'Nota de adimissao' para calcular: valor mínimo e o máximo valor, média, mediana, desvio padrão, os quartis, construir o histograma, boxplot e interpretar os resultados.

### Valores mínimo e máximo

```{r}
min(df$Nota.de.admissao)
max(df$Nota.de.admissao)
```

### Média e mediana

```{r}
mean(df$Nota.de.admissao)
median(df$Nota.de.admissao)
```


### Desvio padrão
```{r}
sd(df$Nota.de.admissao)
```

### Quartis

```{r}
quantile(df$Nota.de.admissao)
```

### Resumo

```{r}
summary(df$Nota.de.admissao)
```

### Histograma

```{r}
hist(df$Nota.de.admissao, main = "Histograma da nota de adimissão", xlab = "Nota de adimissão", ylab = "Frequência", col = "mediumblue", xlim = c(80, 200), ylim = c(0, 1000))
abline(v = mean(df$Nota.de.admissao), col = "pink", lwd = 2, lty = 2) # Linha que marca a média
abline(v = median(df$Nota.de.admissao), col = "purple", lwd = 2, lty = 2) # Linha que marca a mediana
legend("topright", legend = c("Média", "Mediana"), col = c("pink", "purple"), lwd = 2, lty = c(2, 2))
```


Observamos que o intervalo [125–130] é o que tem a maior frequência de notas e que também inclui a média (126,98) e a mediana (126,1), sugerindo uma distribuição simétrica em torno desse valor.


### Boxplot

```{r}
boxplot(df$Nota.de.admissao, main = "Boxplot da nota de admissão", xlab = "Nota de admissão", ylim = c(90, 200), col = "mediumblue", horizontal = TRUE) 
```


A maioria das notas está concentrada no intervalo [95-160], com algumas poucas notas acima de 160 classificadas como outliers e sem valores extremos. Nota-se também a posição da mediana próxima do centro da caixa, sugerindo que a distribuição de dados é simétrica.


## 3. Análise bivariada (Categórica x Categórica)

A análise bivariada é um método estatístico que examina a relação entre duas variáveis, buscando determinar se existe uma conexão entre elas e, em caso afirmativo, qual a intensidade e direção dessa relação.

Para o prossedimento do item 3, escolhemos as coluna 'Gênero' e 'Resultado' para fazer uma análise bivariada com duas colunas categóricas escolhidas da base de dados,
fazer gráficos e interpretar os resultados.

### Tabela de frequencias e por porcentagem de sucesso

```{r}
tabela <- table(df$Genero, df$Resultado) # relação estre Gênero e Resultado
tabela
prop_por_genero <- prop.table(tabela, margin = 1)  # margem 1 = por linha (gênero)
round(prop_por_genero, 3) # arredonda o valor para 3 casas
```

### Gráficos
```{r}
barplot(tabela, col = c("mediumblue", "pink"), main = "Relação entre resultado por quantidade de homens e mulheres", xlab = "Gênero", ylab = "Quantidade", ylim = c(0, 2500))
legend("topright", legend = c("Homem", "Mulher"), fil = c("mediumblue", "pink"))
```


As mulheres correspondem à maior proporção de estudantes matriculados nos cursos analisados.


```{r}
barplot(prop_por_genero, beside = TRUE, col = c("mediumblue", "pink"), main = "Proporção dos Resultados por Gênero", xlab = "Gênero", ylab = "Proporção", ylim = c(0, 0.7))
legend("topright", legend = c("Homem", "Mulher"), fil = c("mediumblue", "pink"))
```


Embora haja mais mulheres nos cursos, os homens apresentam um número maior de desistências.


## 4. Análise bivariada (Categórica x Numérica)

A análise bivariada categórica x numérica envolve o estudo da relação entre uma variável categórica (qualitativa) e uma variável numérica (quantitativa). Essa análise busca identificar se a variável numérica varia conforme a categoria da variável categórica, ou seja, se existe uma relação entre elas.

Para o prosseguimento do item 4, escolhemos as colunas 'Bolsista' e 'Media das notas do primeiro semestre' para fazer gerar um gráfico boxplot considerando as duas e interpretar os resultados.

Como justificativa para a escolha de colunas a variável 'Bolsista' foi escolhida por representar uma característica socioeconômica relevante dos estudantes, indicando se recebem ou não algum tipo de apoio financeiro institucional. Já a variável 'Media das notas do primeiro semestre' reflete o desempenho acadêmico inicial do aluno.

Ao relacionar essas duas variáveis, buscamos verificar se há diferença significativa no desempenho acadêmico entre bolsistas e não bolsistas. Essa análise pode ajudar a identificar possíveis impactos da concessão de bolsas sobre o rendimento escolar e, consequentemente, contribuir para a avaliação de políticas de assistência estudantil.

```{r}
quantile(df$Media.das.notas.do.primeiro.semestre)
faixa_quartis <- cut(df$Media.das.notas.do.primeiro.semestre, breaks = quantile(df$Media.das.notas.do.primeiro.semestre, probs = seq(0, 1, 0.25)), include.lowest = TRUE, labels = c("[0, 11)", "[11, 12.28)", "[12.28, 13.4)", "[13.4, 18.87]"))
tabela <- table(df$Bolsista, faixa_quartis)
tabela
boxplot(Media.das.notas.do.primeiro.semestre ~ Bolsista, data = df, col = c("red", "green"), main = "Desempenho de Bolsistas e Não Bolsistas", ylab = "Bolsista", xlab = "Média das notas do primeiro semestre", horizontal = TRUE)
```


O gráfico indica que os alunos bolsistas tendem a apresentar desempenho acadêmico superior no primeiro período, já que a mediana das suas notas é mais alta em comparação aos não bolsistas.


## 5. Matriz de correlação

Uma matriz de correlação é uma tabela que exibe os coeficientes de correlação entre múltiplas variáveis. Ela mostra a força e a direção da relação entre cada par de variáveis em um conjunto de dados.

```{r}
df_numericas <- df[sapply(df, is.numeric)]
matriz_correlacao <- cor(df_numericas)
matriz_correlacao
```

## 6. Análise bivariada (Numérica x Numérica)

A análise bivariada numérica x numérica examina a relação entre duas variáveis quantitativas (numéricas). O objetivo é identificar se existe uma associação entre essas variáveis e, em caso positivo, determinar a força e a direção dessa relação.

Para o prosseguimento do item 6, escolhemos as colunas 'Nota de adimissao' e 'Media das notas do primeiro semestre' para fazer gráfico de dispersão, a linha de tendência dos dados, a correlação entre as duas variáveis, mostrar a equação da reta ajustada e o coeficiente de determinação.

```{r}
plot(df$Nota.de.admissao, df$Media.das.notas.do.primeiro.semestre, col = "mediumblue", pch = 19, xlab = "Notas de admissão", ylab = "Média das notas do primeiro período", main = "Desempenho no primeiro período em relação a nota de adimissão")
ml <- lm(df$Media.das.notas.do.primeiro.semestre ~ df$Nota.de.admissao)
abline(ml, col = "red", lwd = 2)
ml <- lm(Media.das.notas.do.primeiro.semestre ~ Nota.de.admissao, data = df)
coeficientes <- coef(ml)  # Aqui você cria o vetor com intercepto e inclinação
r <- cor(df$Nota.de.admissao, df$Media.das.notas.do.primeiro.semestre)
cat("Coeficiente de correlação linear: ", round(r, 4), "\n")
a <- round(coeficientes[2], 4)  # Inclinação
b <- round(coeficientes[1], 4)  # Intercepto
cat("Equação da reta: Média das notas do primeiro semestre =", a, "* Nota de admissão +", b, "\n")
```


Por mais que haja bastante variação, a linha apresenta uma tendência ascendente, demonstrando uma relação positiva entre a nota de admissão e o desempenho no primeiro período.


## 7. Perguntas de estatística bivariada

### 1. Quais fatores mais impactam na desistencia do aluno?

Preparação dos dados

```{r}
df_q1 <- df[df$Resultado == "Desistente",c("Deslocado", "Necessidades.educacionais.especiais", "Devedor", "Bolsista", "Materias.do.primeiro.semestre.aprovadas")]
sum(df$Resultado == "Desistente") # Confirmando a quantidade de daodos
nrow(df_q1)
deslocado <- table(df_q1$Deslocado)
necessidades <- table(df_q1$Necessidades.educacionais.especiais)
devedor <- table(df_q1$Devedor)
bolsista <- table(df_q1$Bolsista)
dados <- rbind(bolsista, devedor, deslocado, necessidades)
dados
barplot(dados, col = c("mediumblue", "red", "yellow", "green"), main = "Relação dos dados e resultado na graduação", xlab = "Dados", ylim = c(0, 1600), beside = TRUE)
legend("topright", legend = c("Bolsistas", "Devedores", "Deslocado", "Necessidades educacionais especiais"), fil = c("mediumblue", "red", "yellow", "green"))
```


Os gráficos mostram o número bruto de desistentes classificados pela presença de um dos quatros fatores ou não. Em questão de números, os alunos que foram deslocados são os que mais desistem.


```{r}
calc_prop <- function(var_nome) {
  desistentes_sim <- sum(df_q1[[var_nome]] == "Sim")
  total_sim <- sum(df[[var_nome]] == "Sim")
  return(round(desistentes_sim / total_sim, 3))
}

# Aplicando a função
prop_bolsista <- calc_prop("Bolsista")
prop_devedor <- calc_prop("Devedor")
prop_deslocado <- calc_prop("Deslocado")
prop_nees <- calc_prop("Necessidades.educacionais.especiais")

# Juntando em uma tabela
proporcoes <- c(Bolsista = prop_bolsista, Devedor = prop_devedor, Deslocado = prop_deslocado, Necessidades = prop_nees)

barplot(proporcoes, col = "steelblue", ylim = c(0, 1), main = "Proporção de Desistentes em cada Grupo", ylab = "Proporção", las = 1)
```


O gráfico revela que os alunos devedores e aqueles com necessidades especiais apresentam as maiores taxas proporcionais de desistência. Isso sugere que fatores financeiros e de acessibilidade podem estar fortemente associados à evasão escolar. 

### 2. Qual a relação entre idade e sucesso na graduação?

```{r}
boxplot(df$Idade.na.inscricao ~ df$Resultado, horizontal = TRUE, col = c("red", "mediumblue", "green"), xlab = "Idade na inscrição", ylab = "Resuldado", main = "Relação entre idade na incrição e Resultado")
```


Por meio das medianas o gráfico indica que os alunos que desistem tendem a ser mais velhos enquanto os alunos graduados se encontram na faixa dos 20 anos quando se inscreveram.


### 3. Alunos bolsistas obtém melhores resultados?

```{r}
boxplot(df$Media.das.notas.do.primeiro.semestre ~ df$Bolsista, horizontal = TRUE, xlab = "Média das matérias do primeiro período", ylab = "Bolsista", col = c("mediumblue", "red"))
```


O gráfico indica que os alunos bolsistas tendem a apresentar desempenho acadêmico superior no primeiro período, já que a mediana das suas notas é mais alta em comparação aos não bolsistas.